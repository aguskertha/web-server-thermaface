

<div class="container-fluid">

    <!-- Page Heading -->
    <h2 style="font-family: san-serif;" class="text-left font-weight-bold ml-3">Visitor Monitoring</h2>
    <a style="text-decoration:none; color: rgb(102, 99, 99); margin-left: 15px;" href="/dasboard">Home</a> / Visitor Monitoring

    <!-- DataTales Example -->
    <div class="card shadow mb-4 mt-4" style="padding: 20px;">
        <div class="row mt-4 ml-3 mr-3">
        <div class="col-md-4">
            
            <!-- <label class="my-1 mr-2">Filter Based on Date range:</label>
            <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text"><i class="far fa-clock"></i></span>
                </div>
                <input type="text" name="daterange" class="form-control float-right" id="reservationtime">
            </div> -->
            <label class="my-1 mr-2">Device & Group Id:</label>
            <div class="input-group">
                <select class="form-control" id="deviceId">
                    <option selected value="TF0187">TF0187</option>
                                                                                                        </select>
            </div>
        </div>
        <div class="col-md-4">
        </div>
        <div class="col-md-4">
            <i class="fas fa-chart-pie"> <span>Statistic:</span></i> 
            <div class="table-responsive">
            <table class="table table-bordered" >
                <thead>
                    <tr>
                    
                    <th style="background-color: rgb(0, 0, 255); color: white; " scope="col" class="text-center">Recognition Count</th>
                    <th style="background-color: rgb(42, 179, 7); color: white; " scope="col" class="text-center">Normal Count</th>
                    <th style="background-color: rgb(255, 40, 40); color: white; " scope="col" class="text-center">Abnormal Count</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                
                    <td class="text-center" style="background-color: rgb(0, 0, 255); color: white; "><%= countAllVisitors %></td>
                    <td class="text-center" style="background-color: rgb(42, 179, 7); color: white; "><%= countNormalVisitors %></td>
                    <td class="text-center" style="background-color: rgb(255, 40, 40); color: white; "><%= countAbnormalVisitors %></td>
                    </tr>
                
                </tbody>
                </table>
            </div>
        </div>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="ml-3 mr-auto">
                    <a class="btn btn-primary mb-2" onclick="exportPDF()"><i class="far fa-file-pdf"></i> Export PDF</a>
                    <a class="btn btn-success mb-2" onclick="exportExcel()"> 
                        <i class="far fa-file-excel"></i> Export Excel
                    </a>
                </div>
            </div>
            
            <div class="container-fluid bg-white shadow-sm bg-body rounded py-3 m-3">
                <table class="table caption-top table-paginate-patient flex" id="my-table" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th>Datetime</th>
                            <th>Photo</th>
                            <th>Name</th>
                            <th>Temperatur</th>
                            <th>Status Temp</th>
                            <th>Status Mask</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% for( let index = 0; index < visitors.length; index++ ) { %>
                        <% const visitor = visitors[index] %> 
                            <tr>
                                <td><%= visitor.datetime %></td>
                                <td><img src="<%= visitor.pictureURL %>" width="100px" alt=""></td>
                                <td><%= visitor.name %></td>
                                <td><%= visitor.temp %></td>
                                <td><%= visitor.stTemp %></td>
                                <td><%= visitor.stMask %></td>
                            </tr>
                        <% } %>
                      
                    </tbody>
                  </table>
            </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
            <script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>
            <script>
                $(document).ready(function () {
                    $('.table-paginate-patient').DataTable();
                });
            </script>
        </div>
    </div>

</div>
<!-- /.container-fluid -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.6/jspdf.plugin.autotable.min.js"></script>
<script>

    function exportPDF(){
        var doc = new jsPDF()
        doc.autoTable({ html: '#my-table' })
        doc.save('pdf-'+(new Date())+'.pdf')
    }

    function exportExcel(file_name, type, fn, dl) {
        console.log('aaa')
        var file_name = 'excel-'+(new Date())
        var elt = document.getElementById('my-table');
        var wb = XLSX.utils.table_to_book(elt, { sheet: "sheet1" });
        return dl ?
            XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }):
            XLSX.writeFile(wb, fn || (file_name + (type || '.xlsx')));
    }

</script>


